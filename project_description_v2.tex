\documentclass[10pt]{myNSF}

\usepackage{amssymb}
\usepackage{natbib}
\usepackage{url}
\usepackage{aastex_macros}
\usepackage{mypack}

\begin{document}

\title{An Ultrawideband Digital Signal Processing System for the Green
  Bank Telescope}
\maketitle

\section{Project Description}
\label{sec:project_description}

\begin{itemize}
\item{\textbf{Note: 15-page limit}}
\item{\textbf{Note: A separate, 2-page data management plan can
      include details on standards used for data and metadata, and
      policies for accessing, sharing, and re-using data}}
\item{\textbf{Note: A separate resources and facilities section can
      include a ``description of the internal and external resources
      (both physical and personnel)'', and this may be a good place to
      discuss local expertise.  We must also include biographical
      sketches that list education, professional preparation, and
      related ``products'', somewhat akin to a CV}}
\end{itemize}

\subsection{Overview}
\label{sec:overview}

We propose to use state-of-the-art technologies to build an
ultra-wideband digital signal processing (UWB-DSP) system that will be
integrated into a new radio receiver under development for the Robert
C.\ Byrd Green Bank Telescope (GBT) at the Green Bank Observatory
(GBO).  Our UWB-DSP system will consist of fast, high bit-depth
analog-to-digital converters (ADCs) that will directly sample the
entire $0.7$--$4\; \GHz$ radio frequency (RF) bandwidth of the new
ultra-wideband receiver (UWBR), bypassing the GBT's usual system of
analog mixers and filters that convert the RF signal to an
intermediate frequency (IF).  The UWB-DSP system will also implement
real-time radio frequency interference (RFI) excision using
statistical and new machine learning (ML) algorithms to identify RFI
in the presence of astronomical signals.  The combination of real-time
RFI removal and high dynamic range digitization as close as possible
to the front-end receiver will make this complete UWB system
**significantly** \textbf{(better word choice?)} more resistant to RFI
than is currently possible with existing technology on the GBT.  This
is crucially important given the experiences of a similar UWB system
that has been deployed on the Effelsberg Radio Telescope that was
crippled by strong interference.

The primary science motivation for our UWB system is the direct
detection of low-frequency gravitational waves (GWs) via pulsar
timing.  The system will also allow for new, wideband spectral studies
of fast radio bursts (FRBs), magnetars, and other radio transients, as
well as faster surveys of regions rich in molecular lines at these
frequencies (e.g. H{\sc II} radio recombination lines and complex
chemical species).  The UWB-DSP system will use cutting edge digital
hardware, innovative RFI excision techniques not in use at any other
observatories, and pioneering methods for handling very high data
rates using 100-gigabit Ethernet (GbE) protocols.  These will
complement the UWBR, which will deliver a combination of wider
instantaneous bandwidth and lower system noise temperature than was
possible with previous generation technology.  Our project will thus
pair advanced digital and analog technologies for the world's largest
single-dish radio telescope to enable transformative scientific
advances in cutting edge fields of astronomy and astrophysics.

The UWB system will be deployed on the GBT as a facility instrument
open to the full astronomical community via the NSF-funded open skies
program.  This project will also serve as a pilot program for upgrades
to the GBT's existing receivers and IF system.  All of the hardware
design, firmware, and software developed through our efforts will be
made publicly available for use at other observatories, and will be
directly relevant for possible future telescopes such as the Next
Generation Very Large Array (ngVLA) and Square Kilometer Array (SKA).
We will also leverage GBO's leadership in the NSF INCLUDES program to
broaden participation in digital engineering and radio astronomy via
an annual summer camp for undergraduate students.  During this camp
students will directly participate in the RFI excision project by
creating training data sets for machine learning algorithms.  The
students will also be exposed to a wide range of engineering and
scientific disciplines that contribute to the success of GBO, and will
receive interventions that will increase retention in STEM fields
\textbf{(among rural/first generation college students?)}.  This will
create a pipeline of students for GBO's successful summer student
programs (including our NSF-funded REU program), alumni of which have
already contributed to the RFI excision project.  The UWB-DSP project
will thus have an extremely broad impact on the wider scientific
community and the next generation of STEM professionals.

\subsection{Intellectual Merit}
\label{sec:IM}

\subsubsection{Motivation}
\label{sec:motivation}

Our objective is to enable a diverse range of high-impact astronomical
science benefiting from ultra-wide bandwidths at radio frequencies,
particularly the study of pulsars and transients, and of rich
molecular line regions.  We will also develop technical solutions for
sharing the radio spectrum with civil and commercial users.  We
describe the science and technical motivations for this project in
more detail below.

\subsubsubsection{Scientific Motivation}
\label{sec:science_motivation}

\alanheading{The Low-Frequency GW Universe} The primary science driver
of the UWB-DSP system is the direct detection of nanohertz frequency
GWs via pulsar timing, which is the focus of the NSF-supported North
American Nanohertz Observatory for Gravitational Waves Physics
Frontier Center (NANOGrav PFC; \cite{mcl13}).  At these GW
frequencies the dominant source class is expected to be supermassive
binary black holes (SMBBH) in the early stages of inspiral at the
centers of galaxies; exotic sources of GWs such as cosmic strings may
also emit in the $\nHz$-regime.  The NANOGrav PFC and similar
experiments are highly complementary to ground- and space-based laser
interferometers that probe higher GW frequencies, and cosmic microwave
background experiments that probe lower frequencies.  The NANOGrav PFC
is on-track to detect a stochastic GW background within the next 3--5
years \citep{tve+15}, and is already placing important constraints on
the amplitude of this background that informs models of SMBBH
evolution and coupling to the surrounding galactic environments
\citep{abb+16,abb+18}.  The detection of individual continuous wave
sources is expected to follow in the coming decade, which will enable
multi-messenger studies of SMBBH systems.  The NANOGrav PFC also
places the most stringent existing limits on the energy density of
cosmic strings \citep{abb+18}.

The NANOGrav PFC uses the GBT and the William E. Gordon telescope at
the Arecibo Observatory (AO) to observe a pulsar timing array (PTA) of
millisecond pulsars (MSPs) distributed across the sky.  The extremely
high rotational stability of MSPs allows them to be used as clocks
whose ``ticks'' are pulse times of arrival (TOAs) that can be
accurately measured \emph{and predicted} with accuracies of $\lesssim
100\; \ns$ over time scales of decades.  The influence of GWs at the
Earth will cause a $10$--$100\; \ns$ deviation in the TOAs because of
the changing path-length between the observer and the pulsars.  The
quadripolar nature of GWs will specifically cause a quadripolar
angular correlation between pulsars distributed across the sky, which
makes it possible to distinguish between GWs and other sources of TOA
deviations (e.g. uncorrelated effects on individual pulsars, or
observatory clock errors or Solar System effects that will have a
monopolar and dipolar angular correlation, respectively; \cite{hd83}).
This process of pulsar timing demands a complete characterization of
the MSPs themselves, including their rotational, astrometric, and
binary properties.  Thus, other high-impact science emerges from this
project, such as pulsar mass measurements \citep{epe+16}, tests of
general relativity \citep{zsd+15}, and novel constraints on Solar
system planetary ephemerides \citep{abb+18}.

One of the most important steps in obtaining TOAs with the required
accuracy is measuring and correcting for the effects of the ionized
interstellar medium (ISM) on pulsar signals.  One of these effects is
a dispersive delay given by
\begin{equation}
  \Delta t_{\rm DM} = k_{\rm DM} \, \DM(t,f)\, \left( f_{\rm l}^{-2} -
  f_{\rm h}^{-2} \right) ,
\end{equation}
where $k_{\rm DM}$ is a physical constant, $f$ is the radio frequency
and the subscripts denote a lower and higher frequency, and $\DM(t,f)$
is the dispersion measure, i.e. column density of free electrons
between the pulsar and the Earth \citep[e.g.][]{lk12}.  We emphasize
that \DM\ is both time and frequency dependent \citep{css16}, and thus
represents a noise term \emph{that must be measured at each observing
  epoch with a fractional precision of $\sim 10^{-5}$}.

The NANOGrav PFC currently employees a two-receiver strategy at the
GBT to precisely measure DM, observing from $0.72$--$0.92\; \GHz$ and
$1.1$--$1.9\; \GHz$.  This approach is sub-optimal for several reasons.
First, it effectively doubles the observing time needed to obtain a
single TOA.  Second, for operational reasons these observations are
typically scheduled with a separation of a few days, making it
impossible to resolve DM variations on shorter timescales.  \emph{The
  UWB system will double the observational efficiency of
  high-precision pulsar timing programs while providing a factor of
  \textbf{***} improvement in measurements of DM.  When coupled with
  higher pulsar signal-to-noise from the wider instantaneous
  bandwidth, the NANOGrav PFC's sensitivity to GWs will increase at
  twice the rate as without an UWB system}.  This in turn will
effectively double the volume over which the NANOGrav PFC is sensitive
to individual SMBBHs---analogous to the improvement between the first
phase of the Laser Interferometric Observatory for Gravitational Waves
(LIGO) and Advanced LIGO.

\alanheading{Radio Transients} Wide instantaneous bandwidth is
essential for characterizing the spectro-temporal behavior of highly
variable radio transients.  One such population are fast radio bursts
--- millisecond duration radio-frequency pulses that originate in
distant galaxies \citep{lbm+07,tsb+13}.  Their physical origin is one
of the most pressing mysteries in astronomy and will be a major area
of research in the coming decade.  To-date, only one FRB has been
observed to repeat (FRB 121102; \cite{sch+14,ssh+16a}), a fact which
has enabled the only precise interferometric localization of an FRB to
a host galaxy \citep{clw+17,tbc+17}, as well as long-duration study of
the changing characteristics of the bursts (e.g. DM, Faraday rotation
measure (RM), and burst morphology; \cite{msh+18}).  With telescope
like the Australian SKA Pathfinder and the Canadian HI Intensity
Mapping Experiment poised to discover dozens (if not hundreds) of new
FRBs \citep{smb+18,chime18}, more repeaters are sure to follow.

FRB 121102 exhibits dramatic burst-to-burst spectro-temporal variation
including a) a highly variable power-law spectral index; b)
non-power-law spectral shapes including band-limited bursts with
characteristic bandwidths of $\sim***\ \GHz$ ; c) changing peak
frequency; d) changing burst morphology; and e) distinct sub-bursts
that drift towards lower peak frequencies with time in the larger
burst envelope \citep{ssh+16b}.  These features may be intrinsic,
extrinsic, or both --- the sub-burst structure in particular may be a
sign of plasma lenses in the local environment of FRB121102
\citep{cwh+17,myc+18}.  There is also some evidence for secular
changes in DM and RM \citep{msh+18,gsp+18}.  All bursts thus far have
been detected between $\sim 1$--$8\; \GHz$ despite significant
observing campaigns at lower and higher frequencies.

Any theory regarding the nature of FBR 121102 (and presumably at least
some class of FRBs more generally) must explain these properties, so
they serve as a powerful diagnostic tool for understanding FRBs'
physical origins.  However, most burst detections are limited by the
bandwidth of the receiver, so the only way thus far to investigate the
behavior of FRB 121102 over ultra-wide bandwidths has been through
simultaneous observations using multiple telescopes.  This is
obviously logistically complicated and sub-optimal.  Our new UWB
system will enable spectro-temporal studies of FRB 121102 and future
repeating FRBs, answering critical questions such as a) does the
characteristic bandwidth of bursts change with frequency, and if so,
with what form? b) do band-limited bursts appear simultaneously in
widely separated sub-bands? c) do sub-bursts cluster in frequency and
time, or can the peak frequency change on burst-to-burst timescales?
d) what is the burst morphology over ultra-wide bandwidths? e) is the
apparent $\sim 1\; \GHz$ lower limit real or an artifact of
under-sampling at lower frequencies? and f) does DM vary as a function
of frequency in broad-band bursts?  The answers to these questions can
then be quantitatively compared with physical models for FRB emission,
such as the aforementioned plasma-lensing model.

A second class of variables are radio magnetars --- a sub-class of
neutron stars whose emission is powered by the decay of extremely
strong magnetic fields.  To-date only four radio magnetars have been
discovered out of a larger population of 29\footnote{See
  \url{http://www.physics.mcgill.ca/~pulsar/magnetar/main.html} for an
  up-to-date list.} magnetars that emit X-rays and gamma-rays
\citep{crh+06,crh+07,lbb+10,efk+13}.  Their sporadic emission and
variable power-law spectral index, polarization fraction and position
angle, and burst morphology stand in stark contrast to
rotation-powered radio pulsars \citep[e.g.][]{crp+07}, and the
physical processes giving rise to their radio emission remains a
mystery.  As with FRB 121102, spectro-temporal studies have been
limited by the relatively small bandwidth provided by most receivers.
Interestingly, there may be a connection between magnetars and FRBs.
A young, powerful magnetar is one of the leading candidates for the
source of FRB 121102 \citep[e.g.][]{mm18}, and the extremely high RM
observed in FRB 121102 has only one known analog: the radio magnetar
near the center of the Milky Way \citep{efk+13}.  Thus, studies of
magnetars may improve our understanding of FRBs, and vice versa.  The
UWB-DSP system will thus be a powerful tool for expanding our
knowledge of radio transients.

\alanheading{Molecular Line Surveys} \textbf{TODO}

\subsubsubsection{Technical Motivation}
\label{sec:technical_motivation}

The ultra-wide bandwidth observations needed to realize the above
scientific potential come with a number of technical challenges.  One
of the most pressing is the ability to \emph{share the spectrum} with
man-made transmitters, producing scientifically usable data at
frequencies where there is significant, strong RFI.  GBO's location at
the center of the 13,0000 square-mile National Radio Quiet Zone and
smaller West Virginia Radio Astronomy Zone gives it unique
interference protection, but many sources of RFI, such as satellite
transmitters, are unavoidable (for more information on these
interference protection zones see Facilities, Equipment, and Other
Resources).  The ability to effectively coexist with other spectrum
users is made all the more important by the expanding presence of
wireless devices in our lives, and the inevitable pervasiveness of
self-driving cars relying on RADAR or similar active-RF methods for
guidance, as well as the increasing sensitivity and bandwidth of
astronomy receiver systems (and thus the total number of RFI
detections per-second).

We broadly classify techniques for sharing the spectrum into RFI
resistance (i.e., a high linear dynamic range in every component of
the front-end and back-end) and RFI excision (i.e. removal of RFI at
the lowest-possible level of data to improve data quality).  We note
that GBO is taking extreme care to ensure that the front-end UWBR is
sufficiently resistant to RFI as part of a separate research and
development effort, so here we concern ourselves only with the UWB-DSP
system.

\alanheading{RFI Resistance} The GBT currently uses the Versatile
Green Bank Astronomical Spectrometer (VEGAS, developed in part with
support from \textbf{NSF-***}) as its primary digital back-end system.
VEGAS uses eight spectrometer banks each consisting of $2 \times 3\;
\mathrm{Gsps}$ 8-bit ADCs (one for each polarization channel) paired
with a high-performance computer (HPC) equipped with an nVidia GTX 780
graphical processing unit (GPU).  A relatively straightforward
expansion of the HPC system will be sufficient to process the full
bandwidth provided by the UWBR for pulsar and FRB observations, but
this approach comes with significant drawbacks.  Most notably, VEGAS
makes use of the GBTs IF system before digital sampling, which will
expose the UWB system to potential saturation of numerous components
including the RF-over-fiber transceivers, two additional frequency
mixers and bandpass filters, and the VEGAS 8-bit ADCs.  In recent
months GBO staff have become aware of total power instabilities that
are present at a variety of observing bands (most notably L-Band,
i.e. $1$--$2\; \GHz$) and digital back-end systems in addition to
VEGAS.  growing use of automatic dependent surveillance-broadcast
(ADS-B) technology\footnote{ADS-B is used for air traffic control as
  part of the Next Generation Air Transportation System and is
  intended to replace secondary surveillance RADAR.  It will be
  required on all aircraft operating in the United States by 2020.
  See \url{https://www.faa.gov/nextgen/programs/adsb/}} transmitting
at $1.09\; \GHz$; the instability itself has been isolated to analog
components between the RF-over-fiber transcievers and second frequency
mixer.  The UWB system will be exposed to an even worse RFI
environment that includes cellular communication towers, digital
television transmitters, Global Positioning System satellites, airport
radar and aircraft positioning systems, Iridium communication
satellites, and Sirius XM Satellite Radio.  \emph{We thus have
  empirical evidence that illustrates the need to minimize the analog
  components in the UWB signal path and to digitally sample with
  sufficient dynamic range to maintain linearity across $0.7$--$4\;
  \GHz$}.

The UWB-DSP system will accomplish this goal by completely bypassing
the existing GBT IF system, sampling at RF with a minimum of 12-bits
per polarization channel.  This will also provide better spectral
baseline stability.

\alanheading{RFI Excision} GBO has been actively testing several
techniques for automated RFI detection and excision.  These include
the use of median absolute deviation of complex voltage samples,
spectral kurtosis, and a new project using machine learning (ML)
algorithms.  The latter is, to our knowledge, unique among major radio
astronomy observatories.  As part of normal operations the GBT
regularly conducts RFI scans that have resulted in a database of over
20 million instances of narrow-band RFI, resulting in a rich data set
that can be used to train deep neural networks.  However, the
limitations of our existing ROACH2-based DSP hardware prevents us from
fully implementing, testing, and deploying these RFI excision
techniques.  Specifically, this previous generation hardware has a
comparatively low number of on-board resources such as block random
access memory (BRAM), DSP cores, and logic cells, as well as low bandwidth
I/O transceivers.  We have also struggled to meet timing closure using
the Virtex-6 technology for complex firmware designs.

Luckily, new developments in field programmable gate arrays (FPGAs)
and associated tool flows fundamentally change the paradigm for
realizing sophisticated RFI excision techniques.  New FPGAs havex
factors of serveral more memory, logic density, and I/O bandwidth.
Improvements in development tools make it easier to achieve timing
closure and to build complex programs, leading to faster prototyping .
The upcoming Xilinx Versal series artificial intelligence accelerator
chips are also optimized for ML algorithms.  \emph{Our development of
  an UWB-DSP system is perfectly timed to take advantage of these new
  technologies.}

\subsubsection{Innovation}
\label{sec:innovation}

To realize the above scientific and technical goals we will make use
of cutting-edge hardware and innovative DSP techniques.  \emph{We
  emphasize that we will use modular designs that abstract away
  lower-level components.  This will make it easier to rapidly take
  advantage of new technologies as they emerge, so that the impact of
  our efforts will last much longer than a single generation of
  specific technology.}

\subsubsubsection{Next-Generation Hardware}

\emph{We will use acquire and deploy the latest generation of digital
  hardware, far surpassing the DSP capabilities of currently deployed
  instruments.}

\alanheading{New FPGA Boards} GBO's current digital back-end is based
on CASPER ROACH2 boards, which used Xilinx Virtex-6 series FPGAs.  As
part of the UWB-DSP system we will develop a next-generation successor
to the ROACH2.  We have identified the Xilinx Virtex UltraScale+ FPGA
VCU118 evaluation kit as a promising platform.  The VCU118’s FPGA has
significantly more resources than the ROACH2 (allowing larger, more
computationally intense designs), significantly smaller feature size
(simplifying timing-closure), and significantly faster transceivers
(allowing higher I/O bandwidth).  Table \ref{table:fpga} provides a
side-by-side comparison.

\begin{table}[h]
  \centering
  \caption{Comparison of ROACH2 and VCU118 \label{table:fpga}}
  \begin{tabular}{|l|c|c|}
    \hline
    Resource & ROACH2 & VCU118 \\
    \hline
    FPGA System Logic Cells & 476K & 2586K \\
    FPGA DSP Slice & 2016 & 6840 \\
    FPGA BRAM & $38\; \mathrm{Mb}$ & $6840\; \mathrm{Mb}$ \\
    Board DDR4 & $2\; \mathrm{GB}$ & $8\; \mathrm{GB}$ \\
    High-Speed Ethernet & $8 \times 10\mathrm{-GbE}$ & $3 \times 100\mathrm{-GbE}$ \\
    FPGA Silicon Feature Size & $40\; \nm$ & $16\; \nm$ \\
    Expansion Bus & $2 \times \mathrm{ZDOK}$ & $1 \times \mathrm{FMC}$, $1 \times \mathrm{FMC}+$ \\
    Max FPGA transceiver speed & $6.6\; \mathrm{Gbps}$ & $32.75\; \mathrm{Gbps}$ \\
    \hline
  \end{tabular}
\end{table}

One benefit of the ROACH2 over the VCU118 is that the ROACH2 was
specifically designed by a radio astronomy research and
instrumentation organization with radio astronomy applications in
mind, whereas the VCU118 is a development board developed by Xilinx
whose purpose is to exhibit the full range of the possibilities
created by the Virtex UltraScale+ series chips. Functionally, the one
area of the boards where this discrepancy is made obvious is the
high-speed transceivers --- on the ROACH2 all of the transceivers are
connected to expansion bus connectors, whereas many transceivers on
the VCU118 are connected to ``exhibition'' technologies (PCIe, Samtec
FireFly) that we do not intend to use on our deployed
VCU118s. Nevertheless, the overall ``useable'' I/O bandwidth of the
VCU118 far exceeds that of the ROACH2.

\alanheading{High-Speed ADCs} Table \ref{table:adc} compares the
current EV8AQ160 ADC standard with our prospective for use in the
UWB-DSP system (AD9213).  The specifications for the AD9213 are
representative of the upcoming generation of high-speed ADCs. As the
electronics industry advances, so do ADC technologies --- the AD9213
is faster, more precise, and has lower-noise than our current deployed
technology. One large driver behind the lower spur-free dynamic range
is the improved manufacturer-provided calibration techniques for the
suppression of multi-core interleaved spurs that are inherent in
pipelined ADC technologies (considerable work was required by GBO and
CASPER to properly calibrate our existing ADCs).

\begin{table}[h]
  \centering
  \caption{Comparison of ADC Standards \label{table:adc}}
  \begin{tabular}{|l|c|c|}
    \hline
    Feature/Spec & E2V EV8AQ160 & AD AD9213 \\
    \hline
    Max. Sampliing Rate & $5\; \GHz$ & $10.25\; \GHz$ \\
    Bit-depth & 8 & 12 \\
    Spur-free Dynamic Range (@max. rate) & $56\; \mathrm{dBc}$ & $68\; \mathrm{dBc}$ \\
    Power Consumption (@max. rate) & $4.2\; \mathrm{W}$ & $5.1\; \mathrm{W}$ \\
    Effective Number of Bits (@ max. rate) & 7.1 & 8.7 \\
    \hline
  \end{tabular}
\end{table}

\subsubsubsection{Firmware Development}
\label{sec:firmware}

\emph{We will develop firmware designs for the next-generation
  hardware and communication protocols deployed in the UWB-DSP system.
  These designs will be shared widely with the scientific and
  egineering communities.}

In light of the variety of new hardware that we will use in the
UWB-DSP system, a variety of new firmware ``blocks'' (sets of
low-level FPGA code abstracted to a higher level for easier use by
firmware system designers) will need to be developed for interfacing
with various FPGA-facing peripherals as well as for executing advanced
DSP techniques.  In addition, new firmware tools may need to be
developed to allow our CASPER-based designs to take advantage of the
totality of hardware advancements that are provided by Xilinx
Ultrascale+ and later technologies. Much of this new firmware
development can be broken into functional blocks within Xilinx’s
Embedded Developer's Kit (EDK) architecture. ``Basic EDK blocks'' are
primarily dedicated to data processing with no use of peripheral
components (e.g. BRAM, transceivers, Microblaze access, etc.), whereas
``CASPER EDK blocks'' interface with peripherals. Many of the CASPER
EDK blocks exist for earlier generations of hardware, but considerable
work is required to prepare them for the newest generations. A
discussion of prospective developments is provided below.

\alanheading{Peripheral Intefacing} To take advantage of the
possibilities enabled by the newest generation of data-transmission
technologies, GBO intends to create CASPER EDK blocks that interface
with the 100-GbE core (both single-direction and duplex flavors), PCIe
(generations $3 \times 16$ and $4 \times 8$, including monitor and
control (M\&C) of the FPGA board over the PCIe), as well as a block to
interface the FPGA with our custom ADC cards via the FPGA Mezzanine
Card (FMC/FMC+) slots on the VCU118. The 100-GbE blocks and ADC card
block can be considered improvements upon existing capabilities, while
the PCIe interface (and especially the M\&C aspect) will be
groundbreaking in the CASPER community.

\alanheading{DSP Capabilities} In addition to the new functional
blocks listed above, GBO will create additional blocks (basic EDK) to
improve our DSP capabilities. For example, we intend to develop blocks
implementing new RFI-mitigation methods (discussed in more detail in
the \S\ref{sec:rfi_excision}) that are too computationally expensive
to run in real-time on our current hardware. These developments can
largely be considered (with the exception of ML) translations of
algorithmic implementations from Python notebooks to hardware
descriptive languages (HDL).

\alanheading{Heterogeneous Computing} The two preceding sections
address what we must do to harvest the expected fruits of Moore's law
(higher-speed data transmission, higher-density FPGA chips), but
Xilinx has also made great developments in some less obvious
directions. In recent years, their focus has widened to include
heterogeneous computing architectures such as the Manycore Processor
System on Chip (MPSoC), RF System on Chip (RFSoC), and the Adaptive
Compute Acceleration Platform (ACAP).

While all of these advancements open up new, exciting horizons of
system and DSP design, the most exciting possibilities are enabled by
the ACAP architecture (the upcoming chip series is named
Versal). These chips are heterogeneous devices, combining the
generality and accessibility of CPUs, the vector processing power of
GPUs/DSPs, the I/O and memory bandwidth, and adaptability of FPGAs,
and integrated ADCs and digital-to-analog converters (DACs) suitable
for commercial 5G applications. Subsets of these chips were developed
with the deployment of real-time neural-network based ML as the target
applications (upcoming native integration between the Xilinx chips and
common ML suites such as Caffe or TensorFlow via an application
overlay through Xilinx’s Vivado has been announced). A broader
discussion of ML possibilities is provided in the
\S\ref{sec:rfi_excision}.

With such a wide variety of advancements being exhibited in the Versal
series, the depth and breadth of possible firmware developments
required to take advantage of the full suite of improvements is quite
large. CASPER EDK blocks could \textbf{(Could or will?)} be developed
to interface the scalar processing, vector processing and programmable
logic portions of the chip, which will enable acceleration of our DSP
algorithms and a faster and less intrusive M\&C methodology compared to
the current CASPER standard of interfacing via a soft-core Microblaze
processor.

Additionally, while the ADCs that are integrated with the ACAP may be
too slow for the high-bandwidth, high time-resolution requirements of
many upcoming radio astronomy instruments, possessing integrated,
high-speed DACs (Xilinx’s integrated DACs have so far been
significantly faster than their ADCs) will allow us to improve on our
ability to perform full-system tests.  This will not only accelerate
our design-to-deployment cycle, but would also allow more robust,
realistic, and real-time evaluation of future algorithms.
\textbf{(How?)}.  Thus, creating CASPER EDK blocks that interface the
ADCs/DACs with the tool flow will enable improved test methodologies,
and the use of the ADCs (lowering the system-cost for systems where
the speed is acceptable).

Finally, developing a methodology for tying together Xilinx’s upcoming
ML application overlay with the CASPER tool flow will enable the
implementation of real-time ML algorithms for applications such as
transient detection and RFI-mitigation.

\subsubsubsection{Data Transmission Methods and Topology}

Our plan for the UWB-DSP system calls for a move from IF-over-fiber
with sampling in the GBO equipment room (over $1\; \km$ from the GBT)
to sampling the receiver itself.  This approach will quintuple the
bit-rate compared with previous instruments and will require the use
of 100-GbE fiber downlinks to the equipment room as the backbone of
our signal sampling/transmission pipeline.  We will thus need to
develop solutions to mitigate a several challenges.

For example, the AD9213 analog-to-digital converter's power
dissipation is 5.1W, compared to the 10W maximum power dissipation
allowed per the VME International Trade Association (VITA) 57
specification for the FMC/FMC+ daughter card specification. Since each
VCU118 contains only a single VITA 57-compliant connector with
high-speed transceivers, we will likely need to either develop
power-mitigation methods that would allow us to safely contravene the
standards (allowing multiple ADCs per VCU118), or we would need to
develop robust methods of cross-board ADC clock synchronization
(single ADC per VCU118) to ensure that our dual-polarized samples are
coherent. We will also then have to develop custom ADC boards that
complies with our preferred method.

Continuing with the AD9213 as an archetype of the upcoming generation
of ADCs, the total maximum bit-rate will be $12\; \mathrm{bits} \times
10 \mathrm{GSPS} = 120\; \mathrm{Gbps}$.  This is more than a single
100-GbE port is capable of handling.  With the majority of new Xilinx
FPGA boards having only $2 \times 100$-GbE ports (the VCU118 is an
outlier with $2 \times100$-GbE QSFP28 ports and $1 \times 100$-GbE
FireFly port), we are in an age of technological development where the
ADC bit-rates are growing faster than the I/O bandwidth of FPGA
boards. This will spur examinations of optimal network topologies (one
or two polarizations per receiver-room board? one or two polarizations
per board? 100-GbE duplex? how comparatively large is the 100-GbE
duplex logic to single-direction logic?), and other related questions
that will allow us to maximize our system's throughput bandwidth while
minimizing system cost and complexity.

A new trend among FPGA board designers is to include a PCIe
edge-connector while also eliminating the 1-GbE port that we have used
for FPGA-related M\&C functions in previous designs. This trend will
require us to integrate PCIe-based M\&C functionality, and to measure
how different bi-directional M\&C data-rates between the host computer
and the FPGA over the PCIe bus effect the main, uni-directional
data-transfer rates from the FPGA to the host computer.

\textbf{(This section could use a punch line statement summarizing
  what we plan to do to investigate/solve these issues.)}

\subsubsubsection{Active RFI excision}
\label{sec:rfi_excision}

\emph{We will implement real-time techniques for actively identifiying
  and excising RFI, along with standard acceptance procedures.}

Real-time RFI excision is a critical component of the UWB-DSP system
that is broadly applicable to other observatories and instruments.
Below we describe the techniques that we plan to deploy as part of
this project.  In addition, we will develop a generalized test
methodology for validating the efficacy of these techniques while
preserving scientific data quality --- such a methodology does not
exist in the public domain, but would be a great boon to the future of
the larger community and is critical to building confidence in the new
techniques among scientific users.

\alanheading{Robust Recursive Power Estimator} GBO has built upon
work started at the Nan\"{c}ay Radio Observatory \citep{dwr17} that
detects and excises interference from ground-based RADAR sources, and
which should be applicable to other impulsive sources of RFI.  It
functions by measuring the frequency-domain mean power level and flags
or replaces sets of samples that exceed a given threshold for a given
amount of time (detection is based both on power and duration of the
pulse).  \emph{Members of our team have now implemented this
  functionality in firmware, and have successfully conducted intitial
  validation of its efficacy on multiple back-end systems currently
  being used at GBO.  To the best of our knowledge, GBO currently
  possesses the only CASPER-implemented real-time RFI-excision enabled
  back-end systems.}  We will generalize this method to other sources
of RFI and deploy it in the UWB-DSP system.

\alanheading{Spectral Kurtosis} Initially conceived at the Center for
Solar-Terrestrial Research at New Jersey Institute of Technology as a
robust statistical RFI detector \citep{ng10,nhmg16}, the simple
sum/sum-squared algorithm lends itself naturally to implementations in
FPGAs.  As kurtosis measurements are more affected by a few, extreme
outliers rather than many, moderate outliers, we can assume that any
high-kurtosis samples (above user-adjustable thresholds) are
contaminated with RFI and are mitigated.  

Over the past year, a collaboration between the GBO digital
engineering group and West Virginia University Physics department have
created a python-based implementation of the generalized spectral
kurtosis estimator \citep{ng10}, and its overall effectiveness has
been proven. However, our current implementation is not real-time, and
has been designed specifically using archived complex voltage data
gathered as part of GBT pulsar observation.  None of our extant
back-end systems have enough logic/DSP cores and RAM resources
available in the FPGA chips to allow an implementation to co-exist
with the existing channelization firmware that currently occupies
ever-growing percentages of the available resources on our current
hardware. Acquisition of newer FPGAs with three to five times more
logic/DSP cores and RAM resources would enable us to create and test a
real-time implementation of this method that could then be shared with
the wider community.  SpectralkKurtosis has also been identified as a
promising method for the detection and classification of astrophysical
transients \cite{nhmg16}.  \emph{Our UWB-DSP system will thus enable
  real-time detection of FRBs and other scientifically interesting
  transients.}

\alanheading{Machine Learning} ML is subset of artificial intelligence
whose applicability and accessibility has increased dramatically in
recent years. In response to industry trends, Xilinx has recently
taken steps to optimize their hardware (see \S\ref{sec:firmware}) and
software for easier development and faster run-time of ML algorithms.
The Xilinx ML-suite is also compatible with the Alveo-series chips,
but the Versal series is advertised as being intentionally optimized
for such applications.

While there have been some promising investigations into Machine
Learning’s applications to the astronomical community in areas such as
RFI-detection \citep{wol16}, source classification
\citep{zbm+14,at17}, and transient-detection \citep{zgf+18}, a
concerted effort to create a validated, real-time algorithm, or to
even publish an open-source dataset for training and testing a model
to our specifications has yet to come to fruition.  GBO intends to
utilize the Xilinx's new hardware and software advances in concert
with the datasets outlined below to bring real-time ML applications to
life in the astronomical community.

\textbf{(For Luke: I think we need to discuss the specific techniques
  we might use in more detail)}

\alanheading{Standardized Verification and Qualification Procedures}
While being able to accurately and precisely detect/remove RFI is an
important and difficult problem to solve, it is not necessarily more
difficult or important than defining a methodology for ensuring the
efficacy of specific removal techniques while preserving the
underlying scientific data of interest.  This will also be essential
to convincing scientific users that the procedures preserve the
integrity of the data.  We will create just such a procedure that will
consist of:
\begin{itemize}
\item{Well defined observing modes (e.g. pulsar timing and H{\sc I}
  spectroscopy), astrophysical sources, and quantifiable parameters
  that can be measured from each observation, that will serve as
  standards against which different observatories and instruments can
  test RFI excicision techniques.}
\item{A database of common RFI characteristics such as frequency,
  amplitude, bandwidth, duration, and fequency sweep.}
\item{Carefully curated datasets created using the above set-ups, in
  common formats and containing a variety of RFI sources, that can be
  used for off-line testing and validation.}
\item{Synthetic datasets, both free of RFI and with RFI injected that
  matches common sources, to be used for additional, carefully
  controlled offline verfication.}
\item{Procedures for applying and quantifying the efficacy of RFI
  excision algorithms and assessing their impact on the measurable
  astrophysical quantities of interest.}
\item{Best practices for applying the above to real-time data
  acquisition systems (e.g. techniques for parallel capture of
  RFI-mitigated and unmitigated data streams).}
\item{Side-by-side comparison of the relevant parameters for mitigated
  and unmitigated data.}
\end{itemize}

The limits for acceptable amounts of RFI non-detections,
false-positives, and data perturbations are likely to be specific to
the scientific requirements of a given observation, so we will focus
on \emph{how} to measure the impact of RFI excision in ways that are
reliable \emph{and replicable}.  Observers and other facilities can
then choose the most appropriate procedures for applying these
algorithms as needed.

Test procedures and data sets will be developed openly and
collaboratively, allowing for contributions from other researchers and
observatories.  \emph{We will thus create a community-oriented,
  self-sustaining resource that will be vitally important for ensuring
  the integrity of scientific data as new instruments and telescopes
  are developed alongside increasing use of the radio spectrum.}

\subsubsubsection{Interference Compliance and Cooling}

As an inherent feature of transitioning toward receiver-room signal
sampling, we will need to install relatively large, digitally noisy
electronics in an environment that mandates minimal power consumption
and a low-level of emitted radio-frequency emissions.

GBO requires that all installed electrical equipment in the GBT
receiver room be ITU-R RA.769 compliant (protection criteria used for
radio astronomical measurements), whereas equipment in typical
commercial applications in the United States is only required to be 47
C.F.R. 15 Class A compliant. Functionally, this equates to GBO being
responsible for providing an additional $\sim 100\; \mathrm{dBm}$ of
isotropic radiated power suppression to any commercial-off-the-shelf
(COTS) unintentional radiators that we wish to install close to the
focal point of the GBT.

To meet these strict requirements (and limit unwanted perturbations of
the yet-to-be sampled data), we will likely have to make considerable
adjustments and/or add shielding to any COTS boards (such as the
VCU118) that are used in the UWB-DSP system.  This is an area where we
have considerable expertise and experience. Suppression methods that
we have used previously on COTS equipment include component-level
shielding of ``noisy'' components (chip cage) and equipment-level
shielding (metal box, in-case RF absorbent foam). We have also
designed low-radiation electronics, and have an excellent RF anechoic
chamber to validate our modifications (see Facilities, Equipment, and
Other Resources).

However, many RFI-shielding techniques, such as encasing boards within
metal boxes, works at cross-purposes with effective cooling
techniques. As such, we will also be developing efficient and simple
cooling methods.  Air-cooling is prefered due to its simplicity, but
water-cooling will be considered if necessary.  Members of our team
have already deployed water-cooling on HPC racks used by the
Breakthrough Listen project (**citation**), and water-cooling has been
used on the GBT as part of a revolutionary new L-Band phased array
feed (**citation**).  \emph{All RFI-shielding and cooling techniques
  used at GBO will be broadly applicable to any observatory interested
  in using noisy COTS hardware near sensitive RF receivers.}

\subsection{Broader Impacts}
\label{sec:BI}

\subsubsection{Commitment to the Public}
\label{sec:commitment}

The UWB-DSP system will be deployed on the GBT as a
facility-supported, general purpose instrument available to all GBT
users.  A majority of GBT time is allocated through the NSF-funded
open-skies program, and is thus open to astronomers anywhere in the
world.  The other primary users of the GBT are the Breakthrough Listen
project and the NANOGrav PFC.  The importance of the UWB system to the
NANOGrav PFC has been explained in \S\ref{sec:science_motivation}, and
it will also be valuable to Breakthrough Listen, as it will allow for
faster surveys for extraterrestrial techno-signatures.  Both NANOGrav
and Breakthrough Listen have committed to making data publicly
available.

All of the hardware designs, firmware, and software produced in the
course of this work will be made freely available to the wider
astronomical and radio science communities for use at other
facilities.  We will use a mix of technical memos, presentations at
conferences, and refereed publications to document and communicate the
results of the work to the broadest possible audiences.  GBO also
hosts thousands of visitors each year through its education and
outreach programs.  Visitors participate in public tours (some of
which are specialized for a technical audience), short educational
courses, and weekend and week-long student camps.  The
co-investigators all participate in these programs and will use these
opportunities to educate the broader public about the UWB system and
radio astronomy more generally.

\subsubsection{Enhanced Infrastructure for Research and Education}
\label{sec:infrastructure}

\subsubsubsection{Maximizing Return from the UWB Receiver}

The UWB-DSP system will be fully integrated into the UWB front-end
receiver.  This will allow us to bypass the existing GBT IF system,
mitigating the risk of non-linear response in the analog components
caused by strong RFI.  By digitizing as close as possible to the
receiver we will also minimize gain fluctuations that can lead to
unstable spectral baselines.  These benefits taken together with the
active RFI identification and excision algorithms will ensure that the
UWB system results in the highest quality science data products under
all observing conditions.

\subsubsubsection{A Pilot Program for Future GBT Upgrades}

The GBT has a flexible IF system that has enabled ground-breaking
discoveries in all areas of astronomy, but it is now over 20 years old
and has several limitations.
\begin{itemize}
  \item{Receivers operating above $12\; \GHz$ could provide $>8\;
    \GHz$ of instantaneous bandwidth but are limited by various
    bandpass filters to no more than $8\; \GHz$ bandwidth, and in many
    cases only $4$--$6\; \GHz$ (see Table \ref{table:rx_bandwidth} for
    details).}
  \item{Multiple spectral windows (up to 64) are formed via a complex
    set of secondary and tertiary mixers and bandpass filters before
    the signal is finally sampled at base-band frequencies.  Once
    again, bandpass filters are a limiting factor, setting a maximum
    separation between spectral windows.  The number of converters
    also limits the maximum number of spectral windows.}
  \item{The secondary and tertiary converters are housed in a building
    over 1-km from the GBT.  The signals are transported via
    RF-over-fiber links which are subject to saturation.}
  \item{All of the above analog components can undergo gain variation
    due to changing environmental conditions.  For very deep
    observations of faint sources the resulting spectral baseline
    changes can limiting.}
  \item{Doppler broadening of spectral lines caused by the Earth's
    motion can be removed by a tunable first-stage frequency mixer,
    but only for a single rest frequency.  More complex Doppler
    tracking (e.g. to account for source motion in a binary system) is
    not possible.}
\end{itemize}

\begin{table}[t]
  \centering
  \caption{Bandwidth of GBT Receivers \label{table:rx_bandwidth}}
  \begin{tabular}{|l|c|c|}
    \hline
    Receiver & Frequency Coverage (GHz) & Max. Instantaneous Bandwidth (GHz) \\
    \hline
    PF1 $342\; \MHz$ & $0.29$--$0.395$ & 0.24 \\
    PF1 $450\; \MHz$ & $0.385$--$0.520$ & 0.24 \\
    PF1 $600\; \MHz$ & $0.510$--$0.690$ & 0.24 \\
    PF1 $800\; \MHz$ & $0.680$--$0.920$ & 0.24 \\
    PF2              & $0.910$--$1.23$ & 0.24 \\
    L-Band           & $1.15$--$1.73$ & 0.65 \\    
    S-Band           & $1.73$--$2.60$ & 0.97 \\
    C-Band           & $3.95$--$8.0$ & 3.8 \\
    X-Band           & $8.0$--$11.6$ & 2.4 \\
    Ku-Band          & $12.0$--$15.4$ & 3.5 \\
    KFPA             & $18.0$--$27.5$ & 1.8 (multi-feed); 8 (single-feed) \\
    Ka-Band MM-F1    & $26.0$--$31.0$ & 4.0 \\
    Ka-Band MM-F2    & $30.5$--$37.0$ & 4.0 \\
    Ka-Band MM-F3    & $36.0$--$39.5$ & 4.0 \\
    Q-Band           & $39.2$--$49.8$ & 4.0 \\
    W-Band MM-F1     & $67.0$--$74.0$ & 6.0 \\
    W-Band MM-F2     & $73.0$--$80.0$ & 4.0 \\
    W-Band MM-F3     & $79.0$--$86.0$ & 4.0 \\
    W-Band MM-F4     & $85.0$--$93.3$ & 4.0 \\
    ARGUS            & $80.0$--$115.3$ & 1.5 \\
    \hline
  \end{tabular}
\end{table}

The digital technology that we propose to use in the UWB-DSP system
has the potential to eliminate nearly all of these restrictions.
Multiple fast ADCs could be employed to sample the full available
bandwidth for single-pixel receivers, and would provide maximum
flexibility when trading bandwidth for pixels in multi-pixel
receivers.  \emph{This could lead to as much as a factor of 20
  increase in survey speed when observing widely spaced spectral lines
  (see Table \ref{table:rx_bandwidth})}.  Digitization would occur at
RF for low-frequency receivers and either in higher Nyquist zones or
after a single down-conversion at higher frequencies.  This would
eliminate most analog components, drastically lowering the risk of
saturation from RFI while providing much better spectral baselines.
Doppler tracking and windowing would be accomplished digitally.
Active RFI mitigation would also be incorporated into all GBT
observing.  This will become increasingly important as more of the
super high and extremely high frequency portions of the spectrum are
used for new technologies (e.g. collision avoidance car RADARs that
operate in the $76$--$81\; \GHz$ band).

\textbf{(TODO: A paragraph on scientific impact)}

\emph{This would be a transformational modernization of
  the GBT, analogous to the upgrades of the ``extended'' Jansky Very
  Large Array, and would revolutionize all areas of GBT science.}  The
UWB-DSP system is a pathfinder that will allow us to determine the
most effective and affordable solutions for these future upgrades.

\subsubsubsection{Relevance for Other Facilities}

The radio astronomy community is planning for major new facilities
that will begin construction and operation in the 2020s, such as the
SKA and ngVLA, in addition to a myriad of experiment-class
instruments.  These next generation telescopes should use next
generation technology, including integrated wideband digitization and
RFI excision.  We emphasize once again that all products supported by
this ATI proposal will be made freely available to the wider
community, including communication protocols, firmware designs, RFI
excision implementations, and tool flows.  Our standardized procedure
for testing RFI-excision algorithms will be of especially long-lasting
impact for existing and future observatories around the world.
Because of our focus on modular design enabling rapid development, our
efforts will also serve as a pathfinder for technologies that will be
deployed on these future facilities.  \emph{The GBT, and single-dish
  telescopes more broadly, are perfect test-beds for new techniques
  and technologies because of their simpler design and signal paths
  (compared to multi-dish arrays).}

\subsubsection{Broadening Participation}
\label{sec:participation}

\begin{itemize}
\item{\textbf{Section lead(s):} Sue Ann Heatherly}
\item{\textbf{Target length:} 2 pages}
\item{Describe the two week annual summer camp and activities related
  to RFI excision, professional development, and STEM retention}
\item{Tie into INCLUDES program}
\end{itemize}

\subsection{Project Management Plan}
\label{sec:plan}

\begin{itemize}
\item{\textbf{Section lead(s):} Laura Jensen}
\item{\textbf{Target length:} 2 pages}
\item{Should align with activities identified in
    \S\ref{sec:innovation}}
\item{Should also include metrics for success and a plan for evaluation}
\item{Can we talk about modular design and future upgrade strategies
  here?}
\end{itemize}

\subsubsection{Work to Be Undertaken}
\label{sec:milestones}

\textbf{(Include roles of all personnel)}

\subsubsection{Evaluation}
\label{sec:evaluation}

\subsubsection{Timeline}
\label{sec:timeline}

\begin{itemize}
\item{A graphical timeline, organized by year and work type}
\item{A narrative description of the timeline}
\end{itemize}

\subsection{Results from Prior NSF Support}
\label{sec:prior_support}

\begin{itemize}
\item{\textbf{Section lead(s):} All (as needed)}
\item{\textbf{Target length:} ? (must be $< 5$ pages)}
\item{\textbf{Note: Only needed for PIs or co-PIs with a current NSF
      award or one with an end date in the past five years.}}
\item{For each award:}
  \begin{itemize}
  \item{NSF Award number, amount, and period of support}
  \item{Title of project}
  \item{Summary of completed/proposed work}
    \begin{itemize}
    \item{Intellectual Merit}
    \item{Broader Impacts}
    \end{itemize}
  \item{List of publications}
  \item{Evidence of research projects and their availability}
  \item{Relation of completed work to proposed work (for renewals
      only)}
  \end{itemize}
\end{itemize}

\bibliography{references}{}
\bibliographystyle{plain}

\end{document}
